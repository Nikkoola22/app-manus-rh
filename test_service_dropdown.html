<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test Menu Déroulant Service</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            padding: 20px;
            background-color: #f5f5f5;
        }
        
        .test-container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        
        .test-section {
            margin-bottom: 30px;
            padding: 20px;
            border: 1px solid #e0e0e0;
            border-radius: 6px;
        }
        
        .test-title {
            font-size: 18px;
            font-weight: bold;
            margin-bottom: 15px;
            color: #333;
        }
        
        .table-simulation {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
        }
        
        .table-simulation th,
        .table-simulation td {
            padding: 12px;
            text-align: left;
            border-bottom: 1px solid #ddd;
        }
        
        .table-simulation th {
            background-color: #f8f9fa;
            font-weight: 600;
        }
        
        .service-cell {
            cursor: pointer;
            padding: 8px;
            border-radius: 4px;
            transition: background-color 0.2s;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }
        
        .service-cell:hover {
            background-color: #f0f0f0;
        }
        
        .service-dropdown {
            padding: 4px 8px;
            border: 1px solid #ccc;
            border-radius: 4px;
            font-size: 14px;
            background-color: white;
        }
        
        .edit-icon {
            width: 12px;
            height: 12px;
            margin-left: 8px;
            color: #666;
        }
        
        .cancel-button {
            padding: 4px 8px;
            margin-left: 8px;
            background-color: #f8f9fa;
            border: 1px solid #ccc;
            border-radius: 4px;
            cursor: pointer;
            font-size: 12px;
        }
        
        .cancel-button:hover {
            background-color: #e9ecef;
        }
        
        .instructions {
            background-color: #fef3c7;
            padding: 15px;
            border-radius: 6px;
            border-left: 4px solid #f59e0b;
        }
        
        .test-results {
            background-color: #f0fdf4;
            padding: 15px;
            border-radius: 6px;
            border-left: 4px solid #22c55e;
            margin: 15px 0;
        }
        
        .test-results h4 {
            margin-top: 0;
            color: #166534;
        }
        
        .checklist {
            list-style: none;
            padding: 0;
        }
        
        .checklist li {
            padding: 5px 0;
            display: flex;
            align-items: center;
        }
        
        .checklist li::before {
            content: "✅";
            margin-right: 10px;
        }
        
        .demo-section {
            background-color: #f8f9fa;
            padding: 20px;
            border-radius: 6px;
            margin: 20px 0;
        }
        
        .demo-title {
            font-weight: bold;
            margin-bottom: 15px;
            color: #333;
        }
    </style>
</head>
<body>
    <div class="test-container">
        <h1>Test Menu Déroulant Service dans la Gestion des Agents</h1>
        
        <div class="instructions">
            <h3>Instructions de Test</h3>
            <ol>
                <li><strong>Clic sur Service :</strong> Cliquer sur le nom du service dans le tableau des agents</li>
                <li><strong>Menu déroulant :</strong> Un menu déroulant doit apparaître avec tous les services disponibles</li>
                <li><strong>Sélection :</strong> Choisir un nouveau service dans le menu déroulant</li>
                <li><strong>Sauvegarde :</strong> Le service doit être mis à jour automatiquement</li>
                <li><strong>Annulation :</strong> Possibilité d'annuler avec le bouton "Annuler"</li>
            </ol>
        </div>
        
        <div class="test-section">
            <div class="test-title">Simulation du Tableau des Agents</div>
            
            <div class="demo-section">
                <div class="demo-title">État Normal (Clic pour éditer)</div>
                <table class="table-simulation">
                    <thead>
                        <tr>
                            <th>Nom</th>
                            <th>Email</th>
                            <th>Rôle</th>
                            <th>Service</th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>Jean MARTIN</td>
                            <td>jean.martin@exemple.com</td>
                            <td>Responsable</td>
                            <td>
                                <div class="service-cell" onclick="simulateEditService(1)">
                                    <span>Ressources Humaines</span>
                                    <svg class="edit-icon" viewBox="0 0 24 24" fill="currentColor">
                                        <path d="M3 17.25V21h3.75L17.81 9.94l-3.75-3.75L3 17.25zM20.71 7.04c.39-.39.39-1.02 0-1.41l-2.34-2.34c-.39-.39-1.02-.39-1.41 0l-1.83 1.83 3.75 3.75 1.83-1.83z"/>
                                    </svg>
                                </div>
                            </td>
                            <td>
                                <button>Voir</button>
                                <button>Modifier</button>
                            </td>
                        </tr>
                        <tr>
                            <td>Marie DUPONT</td>
                            <td>marie.dupont@exemple.com</td>
                            <td>Responsable</td>
                            <td>
                                <div class="service-cell" onclick="simulateEditService(2)">
                                    <span>Informatique</span>
                                    <svg class="edit-icon" viewBox="0 0 24 24" fill="currentColor">
                                        <path d="M3 17.25V21h3.75L17.81 9.94l-3.75-3.75L3 17.25zM20.71 7.04c.39-.39.39-1.02 0-1.41l-2.34-2.34c-.39-.39-1.02-.39-1.41 0l-1.83 1.83 3.75 3.75 1.83-1.83z"/>
                                    </svg>
                                </div>
                            </td>
                            <td>
                                <button>Voir</button>
                                <button>Modifier</button>
                            </td>
                        </tr>
                        <tr>
                            <td>SOFIANE BENDAOUD</td>
                            <td>sofiane.bendaoud@exemple.com</td>
                            <td>Agent</td>
                            <td>
                                <div class="service-cell" onclick="simulateEditService(3)">
                                    <span>Non assigné</span>
                                    <svg class="edit-icon" viewBox="0 0 24 24" fill="currentColor">
                                        <path d="M3 17.25V21h3.75L17.81 9.94l-3.75-3.75L3 17.25zM20.71 7.04c.39-.39.39-1.02 0-1.41l-2.34-2.34c-.39-.39-1.02-.39-1.41 0l-1.83 1.83 3.75 3.75 1.83-1.83z"/>
                                    </svg>
                                </div>
                            </td>
                            <td>
                                <button>Voir</button>
                                <button>Modifier</button>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
            
            <div class="demo-section" id="edit-mode" style="display: none;">
                <div class="demo-title">Mode Édition (Menu déroulant actif)</div>
                <table class="table-simulation">
                    <thead>
                        <tr>
                            <th>Nom</th>
                            <th>Email</th>
                            <th>Rôle</th>
                            <th>Service</th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>Jean MARTIN</td>
                            <td>jean.martin@exemple.com</td>
                            <td>Responsable</td>
                            <td>
                                <div style="display: flex; align-items: center;">
                                    <select class="service-dropdown" onchange="simulateServiceChange(1, this.value)">
                                        <option value="">Sélectionner un service</option>
                                        <option value="1" selected>Ressources Humaines</option>
                                        <option value="2">Informatique</option>
                                        <option value="3">Comptabilité</option>
                                        <option value="4">Médecine</option>
                                        <option value="5">Administration</option>
                                    </select>
                                    <button class="cancel-button" onclick="simulateCancelEdit()">Annuler</button>
                                </div>
                            </td>
                            <td>
                                <button>Voir</button>
                                <button>Modifier</button>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
        
        <div class="test-section">
            <div class="test-title">Fonctionnalités Implémentées</div>
            
            <div class="test-results">
                <h4>✅ Fonctionnalités Ajoutées</h4>
                <ul class="checklist">
                    <li>État d'édition du service pour chaque agent</li>
                    <li>Menu déroulant avec tous les services disponibles</li>
                    <li>Mise à jour automatique via API PUT /api/agents/{id}</li>
                    <li>Bouton "Annuler" pour sortir du mode édition</li>
                    <li>Icône d'édition pour indiquer que le service est cliquable</li>
                    <li>Effet hover pour améliorer l'UX</li>
                    <li>Mise à jour en temps réel de la liste des agents</li>
                </ul>
            </div>
            
            <div class="test-results">
                <h4>🎯 Comportement Attendu</h4>
                <ul class="checklist">
                    <li>Clic sur le service → Mode édition activé</li>
                    <li>Menu déroulant → Liste de tous les services</li>
                    <li>Sélection d'un service → Mise à jour automatique</li>
                    <li>Bouton Annuler → Retour au mode normal</li>
                    <li>Changement de service → API appelée avec PUT</li>
                    <li>Succès → Liste mise à jour localement</li>
                    <li>Erreur → Message d'erreur affiché</li>
                </ul>
            </div>
        </div>
        
        <div class="test-section">
            <div class="test-title">Code Implémenté</div>
            
            <div class="demo-section">
                <h4>État d'édition :</h4>
                <pre><code>const [editingService, setEditingService] = useState(null)</code></pre>
                
                <h4>Fonction de mise à jour :</h4>
                <pre><code>const updateAgentService = async (agentId, newServiceId) => {
  const response = await fetch(`/api/agents/${agentId}`, {
    method: 'PUT',
    body: JSON.stringify({ service_id: parseInt(newServiceId) })
  })
  // Mise à jour de la liste locale
}</code></pre>
                
                <h4>Interface conditionnelle :</h4>
                <pre><code>{editingService === agent.id ? (
  &lt;select onChange={(e) => updateAgentService(agent.id, e.target.value)}&gt;
    {services.map(service => (
      &lt;option key={service.id} value={service.id}&gt;
        {service.nom_service}
      &lt;/option&gt;
    ))}
  &lt;/select&gt;
) : (
  &lt;div onClick={() => setEditingService(agent.id)}&gt;
    {service.nom_service}
  &lt;/div&gt;
)}</code></pre>
            </div>
        </div>
    </div>

    <script>
        function simulateEditService(agentId) {
            document.getElementById('edit-mode').style.display = 'block';
            console.log('Mode édition activé pour l\'agent', agentId);
        }
        
        function simulateServiceChange(agentId, serviceId) {
            console.log('Changement de service pour l\'agent', agentId, 'vers le service', serviceId);
            alert('Service mis à jour ! (Simulation)');
            simulateCancelEdit();
        }
        
        function simulateCancelEdit() {
            document.getElementById('edit-mode').style.display = 'none';
            console.log('Mode édition annulé');
        }
    </script>
</body>
</html>

